<?php
// input_file.php for  in /Users/valentin/Desktop/ProjetPHP/BDPHP/include
// 
// Made by Valentin Carriere
// Login   <carrie_v@etna-alternance.net>
// 
// Started on  Thu Nov 21 15:01:03 2013 Valentin Carriere
// Last update Thu Nov 21 17:59:47 2013 Valentin Carriere
//
function	input_file($file)
{
  $ptr = fopen($file[1], "r");
  $contenu = fread($ptr, filesize($file[1]));
  $params = decoup_line($contenu);
  $cmd = decoup_array($params);
  for ($i = 0; isset($cmd[$i]) && $i < (count($cmd) - 1); $i++)
    {
      user_choice($cmd[$i], $file);
      print_r($cmd[$i]);
    }
}

function        decoup_line($line)
{
  $res = preg_replace('#[ ]{2,}|[\t]#', ' ', $line);
  return explode(";", $res);
}

function        decoup_array($test)
{
  for ($i = 0; isset($test[$i]); $i++)
    {
      $temp = explode(" ", $test[$i]);
      $temp = implode(PHP_EOL, $temp);
      $temp = explode("\n", $temp);
      for ($j = 0; isset($temp[$j]); $j++)
	{
	  $temp[$j] = trim(preg_replace('/\s\s+/',' ', $temp[$j]));
	  $array[$i][$j] = $temp[$j];
	  if (preg_match_all('#,$#', $array[$i][$j], $tab))
	    {
	      $array[$i][$j] = preg_replace('#,$#', '', $array[$i][$j]);
	      $j++
	      $array[$i][$j] = ",";
	    }
	}
    }
  for ($i = 1; isset($array[$i]); $i++)
    {
      unset($array[$i][0]);
      $array[$i] = array_values($array[$i]);
    }
  return $array;
}
